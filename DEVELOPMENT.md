# Development Guide

This guide covers everything you need to know for developing Oak.

## Prerequisites

- macOS 13+ (Apple Silicon recommended)
- XcodeGen (`brew install xcodegen`) - for building from source
- SwiftLint (optional, for code linting: `brew install swiftlint`)
- SwiftFormat (optional, for code formatting: `brew install swiftformat`)

## Building from Source

```bash
# Clone the repository
git clone https://github.com/jellydn/oak.git
cd oak

# Generate Xcode project
cd Oak && xcodegen generate

# Build and run
open Oak.xcodeproj
```

## Build Commands

We use [just](https://github.com/casey/just) for task automation. Here are the available commands:

```bash
# Show available commands
just

# Build the project
just build

# Build release version
just build-release

# Run all tests
just test

# Run tests with verbose output
just test-verbose

# Run a specific test class
just test-class FocusSessionViewModelTests

# Run a specific test method
just test-method FocusSessionViewModelTests testStartSession

# Check for compilation errors
just check

# Clean build artifacts
just clean

# Open in Xcode
just open

# Validate bundled ambient sound files
just check-sounds
```

## Code Quality Commands

```bash
# Lint Swift code
just lint

# Auto-fix linting issues
just lint-fix

# Format Swift code
just format

# Check if code is formatted correctly
just format-check

# Run both lint and format checks
just check-style
```

## Ambient Sound Assets

Oak expects bundled ambient files under `Oak/Oak/Resources/Sounds` with these base names:

- `ambient_rain`
- `ambient_forest`
- `ambient_cafe`
- `ambient_brown_noise`
- `ambient_lofi`

Supported extensions: `.m4a` (preferred), `.wav`, `.mp3`.

### ðŸŽµ Sound Attribution

The ambient sounds included in Oak are sourced from [Pixabay](https://pixabay.com/) under the [Pixabay Content License](https://pixabay.com/service/license-summary/):

- **Rain Sound**: [Real Rain Sound](https://pixabay.com/sound-effects/real-rain-sound-379215/) by feedthestraycats
- **Forest Sound**: [Ambient Spring Forest](https://pixabay.com/sound-effects/ambient-spring-forest-323801/) by soundreality
- **Cafe Sound**: [Cafe Noise](https://pixabay.com/sound-effects/cafe-noise-32940/) by freesound_community
- **Brown Noise**: [Brown Noise](https://pixabay.com/sound-effects/brown-noise-by-digitalspa-170337/) by digitalspa
- **Lo-fi Sound**: [Lofi Guitar](https://pixabay.com/sound-effects/lofi-guitar-105361/) by freesound_community

We are grateful to these creators for making their work available for projects like Oak.

## Project Structure

```
Oak/
â”œâ”€â”€ Oak/
â”‚   â”œâ”€â”€ Models/              # Data models, enums, protocols
â”‚   â”œâ”€â”€ Views/               # SwiftUI Views
â”‚   â”œâ”€â”€ ViewModels/          # ObservableObject classes
â”‚   â”œâ”€â”€ Services/            # Business logic, audio, persistence
â”‚   â”œâ”€â”€ Resources/           # Assets, sounds, config files
â”‚   â””â”€â”€ OakApp.swift        # App entry point
â”œâ”€â”€ Oak.xcodeproj/           # Generated by XcodeGen
â”œâ”€â”€ project.yml              # XcodeGen config (project definition)
â””â”€â”€ Tests/                   # Unit tests
```

**Note**: This project uses [XcodeGen](https://github.com/yonaskolb/XcodeGen) for project management. The Xcode project is generated from `project.yml`. Do not use Swift Package Manager (`swift build` or `swift test`) for this project.

## Development Resources

- [PRD](tasks/prd-macos-focus-companion-app.md) - Product Requirements Document
- [Architecture Decisions](doc/adr/) - ADRs for key technical decisions
- [Agent Guidelines](AGENTS.md) - Development guidelines for contributors

## Contributing

Contributions are welcome! Please ensure your code follows the project's style guidelines and passes all linting and formatting checks before submitting PRs.
